
import requests
import json
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

def wappalyzer(domain,api_key):
    url="https://api.wappalyzer.com/lookup/v1/?url="+domain+"&callback_url="+domain
    headers={
        "x-api-key": "wappalyzer.api.demo.key",
    }
    response=requests.get(url,headers=headers,verify=False)
    data=response.json()
    print(data)
    #data=[{"monthYear":"05-2020","languages":["en"],"applications":[{"name":"Amazon ECS","categories":["IaaS"],"versions":[],"hits":1179},{"name":"Amazon Web Services","categories":["PaaS"],"versions":[],"hits":1179},{"name":"Docker","categories":["Containers"],"versions":[],"hits":1179},{"name":"Azure CDN","categories":["CDN"],"versions":[],"hits":1178}]},{"monthYear":"04-2020","languages":["en"],"applications":[{"name":"Amazon Web Services","categories":["PaaS"],"versions":[],"hits":1091},{"name":"Docker","categories":["Containers"],"versions":[],"hits":1091},{"name":"Amazon ECS","categories":["IaaS"],"versions":[],"hits":1091},{"name":"Azure CDN","categories":["CDN"],"versions":[],"hits":1091},{"name":"Google Analytics","categories":["Analytics"],"versions":[],"hits":489},{"name":"Nginx","categories":["Web servers","Reverse proxies"],"versions":["1.16.0","1.14.2","1.15.3"],"hits":468},{"name":"jQuery","categories":["JavaScript libraries"],"versions":["2.1.3","1.7.1","3.4.1"],"hits":455},{"name":"Python","categories":["Programming languages"],"versions":["3.6","2.7.13"],"hits":235},{"name":"Criteo","categories":["Advertising"],"versions":[],"hits":227},{"name":"XRegExp","categories":["JavaScript libraries"],"versions":["2.0.0"],"hits":212},{"name":"Django","categories":["Web frameworks"],"versions":[],"hits":212},{"name":"RxJS","categories":["JavaScript frameworks"],"versions":[],"hits":208},{"name":"webpack","categories":["Miscellaneous"],"versions":[],"hits":208},{"name":"Apollo","categories":["JavaScript libraries"],"versions":["2.3.5","2.6.3"],"hits":208},{"name":"Lodash","categories":["JavaScript libraries"],"versions":["4.17.4","3.10.1"],"hits":208},{"name":"Google Analytics Enhanced eCommerce","categories":["Analytics"],"versions":[],"hits":203},{"name":"PHP","categories":["Programming languages"],"versions":["5.6.40","7.4.1"],"hits":177}]},{"monthYear":"03-2020","languages":[],"applications":[{"name":"Amazon Web Services","categories":["PaaS"],"versions":[],"hits":608},{"name":"Docker","categories":["Containers"],"versions":[],"hits":608},{"name":"Amazon ECS","categories":["IaaS"],"versions":[],"hits":608},{"name":"Azure CDN","categories":["CDN"],"versions":[],"hits":608},{"name":"jQuery","categories":["JavaScript libraries"],"versions":["2.1.3","1.7.1","1.12.4"],"hits":242},{"name":"Google Analytics","categories":["Analytics"],"versions":[],"hits":206},{"name":"Nginx","categories":["Web servers","Reverse proxies"],"versions":["1.16.0","1.17.2"],"hits":151},{"name":"Google Analytics Enhanced eCommerce","categories":["Analytics"],"versions":[],"hits":151},{"name":"RxJS","categories":["JavaScript frameworks"],"versions":[],"hits":138},{"name":"webpack","categories":["Miscellaneous"],"versions":[],"hits":138},{"name":"Lodash","categories":["JavaScript libraries"],"versions":["4.17.4","3.10.1"],"hits":138},{"name":"Bootstrap","categories":["UI frameworks"],"versions":["3.3.6","4.0.0"],"hits":116},{"name":"Apache","categories":["Web servers"],"versions":["2.4.29","2.4.16"],"hits":111},{"name":"PHP","categories":["Programming languages"],"versions":["5.6.26"],"hits":105}]},{"monthYear":"02-2020","languages":[],"applications":[{"name":"Amazon Web Services","categories":["PaaS"],"versions":[],"hits":0},{"name":"Azure CDN","categories":["CDN"],"versions":[],"hits":0},{"name":"Docker","categories":["Containers"],"versions":[],"hits":0},{"name":"Amazon ECS","categories":["IaaS"],"versions":[],"hits":0}]},{"monthYear":"01-2020","languages":[],"applications":[{"name":"Amazon Web Services","categories":["PaaS"],"versions":[],"hits":0},{"name":"Docker","categories":["Containers"],"versions":[],"hits":0},{"name":"Amazon ECS","categories":["IaaS"],"versions":[],"hits":0},{"name":"Azure CDN","categories":["CDN"],"versions":[],"hits":0}]},{"monthYear":"12-2019","languages":[],"applications":[{"name":"Amazon Web Services","categories":["PaaS"],"versions":[],"hits":22242},{"name":"Docker","categories":["Containers"],"versions":[],"hits":22242},{"name":"Amazon ECS","categories":["IaaS"],"versions":[],"hits":22242},{"name":"Azure CDN","categories":["CDN"],"versions":[],"hits":22225},{"name":"PHP","categories":["Programming languages"],"versions":["5.6.38","5.6.12","7.1.22","7.3.11","7.3.8","7.3.12","7.2.22","7.3.6","7.2.6","7.3.5","7.3.10","7.4.0","4.0.6","7.3.1","7.1.33","7.2.20"],"hits":8792},{"name":"jQuery","categories":["JavaScript libraries"],"versions":["3.1.1","1.12.4","3.3.1","2.0.0","3.4.0","2.1.3","2.2.4","1.11.1","2.2.3","2.2.1","3.4.1","1.5","2.1.4","3.2.1","2.1.1","1.7.1","1.4.2","1.11.2"],"hits":8716},{"name":"Apache","categories":["Web servers"],"versions":["2.4.29","2.4.35","2.4.38","2.4.16","2.4.18","2.4.39","2.4.33","2.2.15","2.4.6","2.4.25","2.4.41"],"hits":6145},{"name":"Google Analytics","categories":["Analytics"],"versions":[],"hits":5622},{"name":"Ubuntu","categories":["Operating systems"],"versions":[],"hits":5474},{"name":"Bootstrap","categories":["UI frameworks"],"versions":["4.3.1","3.3.1","3.3.6","4.0.0","3.3.4","4.1.1","3.3.7","3.4.1"],"hits":4792},{"name":"jQuery UI","categories":["JavaScript libraries"],"versions":["1.12.1","1.11.4","1.8.5","1.11.0","1.10.4"],"hits":4467},{"name":"Nginx","categories":["Web servers","Reverse proxies"],"versions":["1.15.9","1.14.0","1.16.1","1.16.0","1.10.3","1.17.6","1.6.2","1.14.2"],"hits":4037},{"name":"webpack","categories":["Miscellaneous"],"versions":[],"hits":4006},{"name":"MySQL","categories":["Databases"],"versions":[],"hits":3768},{"name":"Underscore.js","categories":["JavaScript libraries"],"versions":["1.8.3","1.7.0","1.9.1","1.8.2"],"hits":3079},{"name":"Backbone.js","categories":["JavaScript frameworks"],"versions":["1.2.3","1.3.3","1.4.0"],"hits":2871},{"name":"Node.js","categories":["Programming languages"],"versions":[],"hits":2714},{"name":"Google Font API","categories":["Font scripts"],"versions":[],"hits":2708},{"name":"jQuery Migrate","categories":["JavaScript libraries"],"versions":["1.4.1","3.1.0"],"hits":2701},{"name":"Select2","categories":["JavaScript libraries"],"versions":[],"hits":2604},{"name":"Gravatar","categories":["Miscellaneous"],"versions":[],"hits":2588},{"name":"Symfony","categories":["Web frameworks"],"versions":["7","0"],"hits":2158},{"name":"Express","categories":["Web frameworks","Web servers"],"versions":[],"hits":2071},{"name":"Font Awesome","categories":["Font scripts"],"versions":["5.7.1"],"hits":1944},{"name":"React","categories":["JavaScript frameworks"],"versions":["16.9.0"],"hits":1910},{"name":"WordPress","categories":["CMS","Blogs"],"versions":["5.2.3","4.7.15","5.3","5.0.3","4.7.16","5.3.2"],"hits":1873},{"name":"Twitter Emoji (Twemoji)","categories":["Miscellaneous"],"versions":[],"hits":1572},{"name":"Python","categories":["Programming languages"],"versions":[],"hits":1567},{"name":"Hammer.js","categories":["JavaScript libraries"],"versions":["2.0.7"],"hits":1341},{"name":"Lodash","categories":["JavaScript libraries"],"versions":["4.17.15","4.17.11"],"hits":1329},{"name":"RequireJS","categories":["JavaScript frameworks"],"versions":["2.3.3","2.1.11"],"hits":1303},{"name":"RxJS","categories":["JavaScript frameworks"],"versions":[],"hits":1270},{"name":"Google Analytics Enhanced eCommerce","categories":["Analytics"],"versions":[],"hits":1268},{"name":"Angular","categories":["JavaScript frameworks"],"versions":["7.1.0","8.2.14"],"hits":1257},{"name":"Moment.js","categories":["JavaScript libraries"],"versions":["2.24.0","2.10.6","2.22.2","2.21.0"],"hits":1246},{"name":"Zone.js","categories":["JavaScript frameworks"],"versions":[],"hits":1234},{"name":"OroCommerce","categories":["Ecommerce"],"versions":["8","0"],"hits":1221},{"name":"Chart.js","categories":["JavaScript graphics"],"versions":[],"hits":1219},{"name":"Revslider","categories":["Miscellaneous"],"versions":["5.4.8.3","5.4.6.4"],"hits":1079},{"name":"Next.js","categories":["Web frameworks","Web servers"],"versions":[],"hits":1013},{"name":"OpenSSL","categories":["Web server extensions"],"versions":["1.0.1u","1.0.1","1.0.1p","1.0.2s","1.1.1c","1.1.0h","1.1.1b","1.0.2k"],"hits":992}]}]
    if 'message' not in data:
        return data[-1]['applications']
    else:
        return {'Error':data['message']}