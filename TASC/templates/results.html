{% extends "base.html" %}

{% load static %}

{% block content %}

{% if request.user.profile.darkmode %}

  <script>
    var options = {
    bottom: '64px', // default: '32px'
    right: 'unset', // default: '32px'
    left: '32px', // default: 'unset'
    time: '0.5s', // default: '0.3s'
    mixColor: '#fff', // default: '#fff'
    backgroundColor: '#fff',  // default: '#fff'
    buttonColorDark: '#100f2c',  // default: '#100f2c'
    buttonColorLight: '#fff', // default: '#fff'
    saveInCookies: true, // default: true,
    label: 'ðŸŒ“', // default: ''
    autoMatchOsTheme: true // default: true
  }
  const darkmode = new Darkmode(options);
  </script>

  <style>
    .card {
    background-color: #111111;
}
    .card-header {
    color: white;
}

  .card-body p {
    color: white;
}

  </style>

  {% endif %}
  
{% load extras %}
<br>
<script>
function settype(type){
  document.getElementById('type').value=type;
  document.getElementById('search_export').submit();
}
</script>

{% if export != True %}
  <div class="dropdown" align="right">
    <form name="search_export" id="search_export" method="POST" action="/"> {% csrf_token %}
      <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Export as
      <span class="caret"></span></button>
      <ul class="dropdown-menu">
        <li><a role="button" class="dropdown-item" href="javascript:void(0);" onclick="settype('JSON')">JSON</a></li>
        <li><a role="button" class="dropdown-item" href="javascript:void(0);" onclick="settype('PDF')">PDF</a></li>
        <input hidden id="type" name="type" value=""></input>
        <input hidden id="data" name="data" value=""></input>
      </ul>
    </form>
  </div>
{% else %}
<div class="jumbotron">
  <div class="container text-center">
    <img src="http://127.0.0.1:8000/static/images/logo.png" alt="Logo" width="150px" height="100%" style="position:relative" />
    <h1>OSINTsploit</h1>   
    <p>Search Report Export</p>
  </div>
</div>
{% endif %}
<br>
<center>

{% if hlrdata %}
<table class="table table-striped table-bordered">
  <thead>
    <tr>
      <th scope="col"><center>Phone Lookup</center></th>
      <th scope="col"><center>Result</center></th>
    </tr>
  </thead>
  <tbody>

    {% if hlrdata.error %}

    <tr>
      <td scope="row">Error</td>
      <td>{{hlrdata.error}}</td>
    </tr>

    {% else %}
            {% if hlrdata.line_type %}
            <tr>
              <td scope="row">Line Type</td>
              <td>{{hlrdata.line_type}}</td>
            </tr>
            {% endif %}

              <tr>
                <td scope="row">Subscriber Status</td>
                <td>{{hlrdata.subscriberstatus}}</td>
              </tr>

              <tr>
                <td scope="row">IMSI</td>
                <td>{{hlrdata.imsi}}</td>
              </tr>

              <tr>
                <td scope="row">MCC MNC</td>
                <td>{{hlrdata.mccmnc}}</td>
              </tr>

              <tr>
                <td scope="row">Original Network</td>
                <td>{{hlrdata.originalnetworkname}}</td>
              </tr>

              {% if hlrdata.location %}

              <tr>
                <td scope="row">State</td>
                <td>{{hlrdata.location}}</td>
              </tr>
            
              {% endif %}
              
              <tr>
                <td scope="row">Country</td>
                <td>{{hlrdata.originalcountryname}}</td>
              </tr>

            {% if hlrdata.isroaming == "Yes" %}

                <tr>
                  <td scope="row">Roaming Network</td>
                  <td>{{hlrdata.roamingnetworkname}}</td>
                </tr>

                <tr>
                  <td scope="row">Roaming Country</td>
                  <td>{{hlrdata.roamingcountryname}}</td>
                </tr>

            {% endif %}

            {% if hlrdata.isported == "Yes" %}

                <tr>
                  <td scope="row">Ported Network</td>
                  <td>{{hlrdata.portednetworkname}}</td>
                </tr>

                <tr>
                  <td scope="row">Ported Country</td>
                  <td>{{hlrdata.portedcountryname}}</td>
                </tr>

            {% endif %}
    <script>document.getElementById('data').value+="'hlrdata':{{hlrdata|safe}}"+","</script>
    {% endif %}

</tbody>
</table><br>
{% endif %}

{% if fbsearch %}
<div class="card text-center border-primary">
    <div class="card-header">
      Facebook Search Results
    </div>
    <div class="card-body" align="left">
      {% for keys,values in fbsearch.items %}
        {% for key1,value1 in values.items %}
          {% if key1 == "img_url" %}
          <img src="{{value1}}" alt="Post Image" width="100px"/>
          {% else %} 
          <p class="card-text"><strong>{{key1}} : </strong> {{value1}}</p>
          {% endif %}
        {% endfor %}
        <br><br>
      {% endfor %}
    </div>
  </div><br>
  <script>document.getElementById('data').value+="'fbsearch':{{fbsearch|safe}}"+","</script>
{% endif %}

{% if hlrdata.Account_Id %}
<table class="table table-striped table-bordered">
  <thead>
    <tr>
      <th scope="col"><center>ACT Fibernet</center></th>
      <th scope="col"><center>Result</center></th>
    </tr>
  </thead>
  <tbody>

  
    <tr>
      <td scope="row">Account ID</td>
      <td>{{hlrdata.Account_Id}}</td>
     </tr>

    <tr>
      <td scope="row">Subscriber Name</td>
      <td>{{hlrdata.Subscriber_Name}}</td>
     </tr>

    <tr>
      <td scope="row">Bill Number</td>
      <td>{{hlrdata.Bill_No}}</td>
     </tr>

    <tr>
      <td scope="row">Previous Due</td>
      <td>{{hlrdata.Previous_Due}}</td>
     </tr>

    <tr>
      <td scope="row">Current Invoice</td>
      <td>{{hlrdata.Current_Invoince}}</td>
     </tr>

    <tr>
      <td scope="row">Total Payment Due</td>
      <td>{{hlrdata.Total_Payment_Due}}</td>
     </tr>

</tbody>
</table><br>
<script>document.getElementById('data').value+="'hlrdata':{{hlrdata|safe}}"+","</script>
{% endif %}

{% if ip.ipstackdata %}
<table class="table table-striped table-bordered">
  <thead>
    <tr>
      <th scope="col"><center>IP Details</center></th>
      <th scope="col"><center>Result</center></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td scope="row">IP</td>
      <td>{{ip.ipstackdata.ip}}</td>
    </tr>

    <tr>
      <td scope="row">City</td>
      <td>{{ip.ipstackdata.city}}</td>
    </tr>

    <tr>
      <td scope="row">Region</td>
      <td>{{ip.ipstackdata.region}}</td>
    </tr>
    {% if ip.ipstackdata.country_name %}
      <tr>
        <td scope="row">Country</td>
        <td>{{ip.ipstackdata.country_name}}</td>
      </tr>

      <tr>
        <td scope="row">Zipcode</td>
        <td>{{ip.ipstackdata.postal}}</td>
      </tr>
    {% else %}
      <tr>
        <td scope="row">Country</td>
        <td>{{ip.ipstackdata.country_long}}</td>
      </tr>

      <tr>
        <td scope="row">Zipcode</td>
        <td>{{ip.ipstackdata.zipcode}}</td>
      </tr>
    {% endif %}

    <tr>
        <td scope="row">Latitude</td>
        <td>{{ip.ipstackdata.latitude}}</td>
      </tr>

    <tr>
      <td scope="row">Longitude</td>
      <td>{{ip.ipstackdata.longitude}}</td>
    </tr>

    {% if ip.ipstackdata.is_proxy == 1 %}

      <tr>
        <td scope="row">Proxy Type</td>
        <td>{{ip.ipstackdata.proxy_type}}</td>
      </tr>
      <tr>
        <td scope="row">ISP</td>
        <td>{{ip.ipstackdata.isp}}</td>
      </tr>
      <tr>
        <td scope="row">Domain</td>
        <td>{{ip.ipstackdata.domain}}</td>
      </tr>
      <tr>
        <td scope="row">Usage Type</td>
        <td>{{ip.ipstackdata.usage_type}}</td>
      </tr>
      <tr>
        <td scope="row">ASN</td>
        <td>{{ip.ipstackdata.asn}}</td>
      </tr>
    {% else %}
      <tr>
        <td scope="row">Proxy</td>
        <td>False</td>
      </tr>
    {% endif %}
  <script>document.getElementById('data').value+="'ip':{{ip|safe}}"+","</script>
  </tbody>
</table>
{% endif %}

{% if ip.portscan %}
<div class="card text-center border-primary">
    <div class="card-header">
      Default Port Scan
    </div>
  <div class="card-body">
    {% for key,value in ip.portscan.items %}
      {% if key == "hostnames"%}
        <p class="card-text" align="left"><strong>Hostnames :</strong></p>
        {% for host in ip.portscan.hostnames %}
            <p class="card-text" align="left" style = "margin-left: 25px;"> {{host.name}}</p>
        {% endfor %}
      {% elif key == "Ports" and value != None %}
        {% for key1,value1 in value.items %}
            <p class="card-text" align="left"><strong>Port : {{key1}}</strong></p>
              {% for key2,value2 in value1.items %}
                <p class="card-text" align="left" style = "margin-left: 25px;"><strong>{{key2}} : </strong>{{value2}}</p>
              {% endfor %}
              <br>
        {% endfor %}
      {% else %}
        <p class="card-text" align="left" style = "margin-left: 25px;" ><strong>{{key}} : </strong>{{value.ipv4}}</p>
      {% endif %}  
    {% endfor %}
  </div>
</div><br>
{% endif %}


{% if ip.censys %}
<div class="card text-center border-primary">
    <div class="card-header">
      Censys
    </div>
  <div class="card-body" align="left" style = "margin-left: 25px;">
    {% if ip.censys.Error %}
      <p class="card-text"><strong>Error : </strong> {{ip.censys.Error}}</p>
    {% else %}
      {% for key,value in ip.censys.items %}
        {% if key == "autonomous_system" %}
          {% for key1,value1 in ip.censys.autonomous_system.items %}
            <pre><strong>{{key1| pretty_json}} </strong> {{value1 | pretty_json}} </pre>
          {% endfor %}
        {% elif key == "location" %}
          {% for key1,value1 in ip.censys.location.items %}
            <pre><strong>{{key1 | pretty_json}} </strong> {{value1 | pretty_json}}</pre>
          {% endfor %}
        {% else %}
        <pre><strong>{{key | pretty_json}} </strong> {{value | pretty_json}} </pre>
        {% endif %}
      {% endfor %}
    {% endif %}
  </div>
</div><br>
{% endif %}


{% if ip.shodan %}
<div class="card text-center border-primary">
    <div class="card-header">
      Shodan
    </div>
  <div class="card-body" align="left" style = "margin-left: 25px;">
    {% if ip.shodan.Error %}
      <p class="card-text"><strong>Error : </strong> {{ip.shodan.Error}}</p>
    {% else %}
            <pre> {{ip.shodan | pretty_json}} </pre>   
    {% endif %}
  </div>
</div><br>
{% endif %}

{% if btc %}
<div class="card text-left">
    <div class="card-header" align="center">
      BitCoin Info
    </div>
  <div class="card-body">
	{% if btc.error %}
		<p class="card-text"><strong>Error : </strong> {{btc.error}}</p>
	{% else %}
		{% for keys,values in btc.items %}
			{% if keys == "transactions" %}
				<p class="card-text"><strong>{{keys}} : </strong> 
				{% for value in values %}
					<p class="card-text" align="left" style = "margin-left: 25px;">{{ forloop.counter }} : {{value}}</p>
				{% endfor %}
			{% else %}
			<p class="card-text"><strong>{{keys}} : </strong> {{values}}</p>
			{% endif %}
		{% endfor %}
	{% endif %}
	</div>
</div><br>
<script>document.getElementById('data').value+="'btc':{{btc|safe}}"+","</script>
{% endif %}

{% if macdata %}
<table class="table table-striped table-bordered">
  <thead>
    <tr>
      <th scope="col"><center>Mac Address Details</center></th>
      <th scope="col"><center>Result</center></th>
    </tr>
  </thead>
  <tbody>

  {% if Error %}
    <tr>
      <td scope="row"><center>Error</center></td>
      <td>{{Error}}</td>
    </tr>

  {% else %}
    <tr>
      <td scope="row"><center>Manufacturer</center></td>
      <td>{{macdata.Manufacturer}}</td>
    </tr>

    <tr>
      <td scope="row"><center>Address</center></td>
      <td>{{macdata.Manufacturer_Address}}</td>
    </tr>
  <script>document.getElementById('data').value+="'macdata':{{macdata|safe}}"+","</script>
  {% endif %}

</tbody>
</table><br>
{% endif %}

{% if metadata %}
<div class="card text-center border-primary">
    <div class="card-header"><strong>
      Metadata Extraction Results</strong>
    </div>
    <div class="card-body">
  
    {% if metadata.Error %}
      <p class="card-text"><strong>Error : </strong> {{metadata.Error}}</p>

    {% else %}

    {% for key,value in metadata.items %}
      
      {% if value.items and key != "references_dict" %}
        {% for key1,value1 in value.items %}
			{% if value1.items %}
				{% for key2,value2 in value1.items %}
					<p class="card-text" align="left" style = "margin-left: 25px;"><strong>{{key2}} : </strong> {{value2}}</p>
				{% endfor %}
			{% else %}
				<p class="card-text" align="left" style = "margin-left: 25px;"><strong>{{key1}} : </strong> {{value1}}</p>
			{% endif %}
		{% endfor %}
	  {% elif key == "references_dict" %}
		<p class="card-text" align="left"><strong>{{key}} : </strong></p>
		{% for key1,value1 in value.items %}
				<p class="card-text" align="left" style = "margin-left: 25px;"><strong>{{key1}}</strong></p>
			{% for value2 in value1 %}
				<p class="card-text" align="left" style = "margin-left: 50px;">{{value2}}</p>
			{% endfor %}
		<br>
		{% endfor %}
		
	  {% else %}
      <p class="card-text" align="left" style = "margin-left: 25px;"><strong>{{key}} : </strong> {{value}}</p>
	{% endif %}
    {% endfor %}

    {% endif %}
    </div>
  </div><br>
  <script>document.getElementById('data').value+="'metadata':{{metadata|safe}}"+","</script>
{% endif %}

{% if hibp %}

          <table class="table table-striped table-bordered">
          <thead>
            <tr>
              <th scope="col"><center>#</center></th>
              <th scope="col"><center>Have I Been Pwned - Breached Sites</center></th>
            </tr>
          </thead>
          <tbody>

	{% if hibp.Error %}
        <tr>
              <th scope="row"><center>{{ forloop.counter }}</center></th>
              <td>{{hibp.Error}}</td>
         </tr>
      {% else %}

          {% for breached in hibp %}
          
            <tr>
              <th scope="row"><center>{{ forloop.counter }}</center></th>
              <td>{{breached.Name}}</td>
              </tr>

        {% endfor %}
        
      {% endif %}

      </tbody>
      </table>
   
    <br>
    <script>document.getElementById('data').value+="'hibp':{{hibp|safe}}"+","</script>
{% endif %}

{% if slideshare != None %}

          <table class="table table-striped table-bordered">
          <thead>
            <tr>
              <th scope="col"><center>#</center></th>
              <th scope="col"><center>Slideshare - Slide Title</center></th>
              <th scope="col"><center>Link</center></th>
            </tr>
          </thead>
          <tbody>

          {% for title, link in slideshare.slides.items %}
          
            <tr>
              <th scope="row"><center>{{ forloop.counter }}</center></th>
              <td>{{title}}</td>
              <td><center><a href="{{link}}" target="_blank" class="btn btn-primary btn-sm" role="button" aria-disabled="true">Open</a></center></td>
            </tr>

        {% endfor %}
      </tbody>
      </table>
   
    <br>
    <script>document.getElementById('data').value+="'slideshare':{{slideshare|safe}}"+","</script>
{% endif %}

{% if emailrep %}

<div class="card text-center border-primary">
  
    <div class="card-header">
      Email Rep Results
    </div>
    <div class="card-body">
    {% if status not in emailrep.keys %}
      {% for keys,values in emailrep.items %}
          {% if values.items %}
            {% for key1,value1 in values.items %}
              {% if key1 == "profiles"%}
                <p class="card-text" align="left"><strong>{{key1}} : </strong><p>
                {% for profile in value1 %}
                  <p class="card-text" align="left" style = "margin-left: 25px;"><strong>{{forloop.counter}} : </strong> {{profile}}</p>
                {% endfor %}
              {% else %}
                <p class="card-text" align="left"><strong>{{key1}} : </strong> {{value1}}</p>
              {% endif %}
            {% endfor %}
          {% else %}
            <p class="card-text" align="left"><strong>{{keys}} : </strong> {{values}}</p>
          {% endif %}
      {% endfor %}
    {% endif %}
    </div>
</div><br>
<script>document.getElementById('data').value+="'emailrep':{{emailrep|safe}}"+","</script>
{% endif %}

{% if hunterio %}
<div class="card text-center border-primary">
    <div class="card-header">
      Hunter.io Scan Results
    </div>
    <div class="card-body">
    {% if hunterio.Error %}
      <p class="card-text">{{hunterio.Error}}</p>
    {% else %}
  
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Result : </strong> {{hunterio.data.result}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Score : </strong> {{hunterio.data.score}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Email : </strong> {{hunterio.data.email}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Disposable : </strong> {{hunterio.data.disposable}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Webmail : </strong> {{hunterio.data.webmail}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>MX Records : </strong> {{hunterio.data.mx_records}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>SMTP Server : </strong> {{hunterio.data.smtp_server}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>SMTP Check : </strong> {{hunterio.data.smtp_check}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Accept All : </strong> {{hunterio.data.accept_all}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Block : </strong> {{hunterio.data.block}}</p>

    <p class="card-text" align="left"><strong>Sources : </strong></p>

    {% for i in hunterio.data.sources %}

    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Domain : </strong> {{ i.domain }}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>URL : </strong> {{ i.uri }}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Extracted On : </strong> {{ i.extracted_on }}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Last Seen On : </strong> {{ i.last_seen_on }}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Still on Page : </strong> {{ i.still_on_page }}</p>
    <br>

    {% endfor %}

        <br>
    {% endif %}
   </div>
</div><br>
<script>document.getElementById('data').value+="'hunterio':{{hunterio|safe}}"+","</script>
{% endif %}

{% if vechileinfo %}
<table class="table table-striped table-bordered">
  <thead>
    <tr>
      <th scope="col"><center>Vehicle Details Showing in Registering Authority</center></th>
      <th scope="col"><center>Result</center></th>
    </tr>
  </thead>
  <tbody>

  {% for keys,values in vechileinfo.items %}
    <tr>
      <td scope="row"><center>{{keys}}</center></td>
      <td>{{values}}</td>
     </tr>
  {% endfor %}

</tbody>
</table><br>
<script>document.getElementById('data').value+="'vechileinfo':{{vech|safe}}"+" "</script>
{% endif %}

{% if iplats or iplons %}
  <div class="card text-center border-primary">
    <div class="card-header">
        Google Map Locations
    </div>
    <div class="card-body">
      <div id="map"></div>
      <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoidGVjaHdpemFyZDEyOCIsImEiOiJja2E4YzZ2NTcwYmtkMnZxd3ZhZDZ0MndwIn0.ON_gL8_AJafiFdDZnLE_4w';
        var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v11',
        center: [78.9629,20.5937],
        zoom: 5,
        });
        var marker = new mapboxgl.Marker().setLngLat(["{{iplons}}","{{iplats}}"]).addTo(map);
        </script>
  </div>
</div><br>
<!--<script>document.getElementById('data').value+="'iplats':{{iplats|safe}}"+" "</script>
<script>document.getElementById('data').value+="'iplons':{{iplons|safe}}"+" "</script>-->
{% endif %}

{% if gmap3 or ip.gmap3 or ip.gpsmap %}
  <div class="card text-center border-primary">
    <div class="card-header">
      {% if ip.gpsmap %}
        GPS Locations
      {% else %}
        Google Map Location
      {% endif %}
    </div>
    <div class="card-body">
      <div id='map' width="80%" style='height:400px'>
        {% if ip.gpsmap %}
          {% include "gpsmap.html" %}
        {% else %}
          {% include "heatmap.html" %}
        {% endif %}
      </div>
    </div>
  </div><br>
  <!--<script>document.getElementById('data').value+="'gmap3':{{gmap3}}"+" "</script>-->
{% endif %}

</center>

{% endblock %}
