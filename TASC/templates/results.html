{% extends "base.html" %}

{% block content %}
{% load extras %}
<br>
<center>

{% if hlrdata %}
<div class="card text-center">
    <div class="card-header">
      Phone Lookup
    </div>
    <div class="card-body">
      <p class="card-text"><strong>Subscriber Status : </strong> {{hlrdata.subscriberstatus}}</p>
      <p class="card-text"><strong>IMSI : </strong> {{hlrdata.imsi}}</p>
      <p class="card-text"><strong>MCC MNC : </strong> {{hlrdata.mccmnc}}</p>
      <p class="card-text"><strong>Original Network : </strong> {{hlrdata.originalnetworkname}}</p>
      <p class="card-text"><strong>State : </strong> {{hlrdata.location}}</p>
      <p class="card-text"><strong>Country : </strong> {{hlrdata.originalcountryname}}</p>

        {% if hlrdata.isroaming == "Yes" %}

          <p class="card-text"><strong>Roaming Network :</strong> {{hlrdata.roamingnetworkname}}</p>
          <p class="card-text"><strong>Roaming Country :</strong> {{hlrdata.roamingcountryname}}</p>

        {% endif %}

        {% if hlrdata.isported == "Yes" %}

          <p class="card-text"><strong>Ported Network :</strong> {{hlrdata.portednetworkname}}</p>
          <p class="card-text"><strong>Ported Country :</strong> {{hlrdata.portedcountryname}}</p>

        {% endif %}

    </div>
  </div><br>
{% endif %}

{% if fbsearch %}
<div class="card text-center">
    <div class="card-header">
      Facebook Search Results
    </div>
    <div class="card-body" align="left">
      {% for keys,values in fbsearch.items %}
        {% for key1,value1 in values.items %}
          {% if key1 == "img_url" %}
          <img src="{{value1}}" alt="Post Image" width="100px"/>
          {% else %} 
          <p class="card-text"><strong>{{key1}} : </strong> {{value1}}</p>
          {% endif %}
        {% endfor %}
        <br><br>
      {% endfor %}
    </div>
  </div><br>
{% endif %}

{% if hlrdata.Account_Id %}
<div class="card text-center">
    <div class="card-header">
      ACT Fibernet
    </div>
      <p class="card-text"><strong>Account ID : </strong> {{hlrdata.Account_Id}}</p>
      <p class="card-text"><strong>Subscriber Name : </strong> {{hlrdata.Subscriber_Name}}</p>
      <p class="card-text"><strong>Bill Number : </strong> {{hlrdata.Bill_No}}</p>
      <p class="card-text"><strong>Previous Due : </strong> {{hlrdata.Previous_Due}}</p>
      <p class="card-text"><strong>Current Invoice : </strong> {{hlrdata.Current_Invoince}}</p>
      <p class="card-text"><strong>Total Payment Due : </strong> {{hlrdata.Total_Payment_Due}}</p>
      </div>
    </div><br>
{% endif %}

{% if ip.ipstackdata %}
<div class="card text-center">
    <div class="card-header">
      IP Details 
    </div>
    <div class="card-body" align="left" style = "margin-left: 25px;">
      <p class="card-text"><strong>IP : </strong> {{ip.ipstackdata.ip}} </p>
      <p class="card-text"><strong>City : </strong> {{ip.ipstackdata.city}}</p>
      <p class="card-text"><strong>Region : </strong> {{ip.ipstackdata.region}}</p>
      <p class="card-text"><strong>Country : </strong> {{ip.ipstackdata.country_long}}</p>
      <p class="card-text"><strong>Zipcode : </strong> {{ip.ipstackdata.zipcode}}</p>
      <p class="card-text"><strong>Latitude : </strong> {{ip.ipstackdata.latitude}}</p>
      <p class="card-text"><strong>Longitude : </strong> {{ip.ipstackdata.longitude}}</p>

        {% if ip.ipstackdata.is_proxy == 1 %}

          <p class="card-text"><strong>Proxy Type : </strong> {{ip.ipstackdata.proxy_type}}</p>
          <p class="card-text"><strong>ISP : </strong> {{ip.ipstackdata.isp}}</p>
          <p class="card-text"><strong>Domain : </strong> {{ip.ipstackdata.domain}}</p>
          <p class="card-text"><strong>Usage Type : </strong>{{ip.ipstackdata.usage_type}}</p>
          <p class="card-text"><strong>ASN : </strong>{{ip.ipstackdata.asn}}</p>
          <p class="card-text"><strong>ASN Name : </strong>{{ip.ipstackdata.as_name}}</p>

        {% else %}

        <p class="card-text"><strong>Proxy : </strong> False </p>

        {% endif %}

    </div>
  </div><br>
{% endif %}

{% if ip.portscan %}
<div class="card text-center">
    <div class="card-header">
      Default Port Scan
    </div>
  <div class="card-body">
    {% for key,value in ip.portscan.items %}
      {% if key == "hostnames"%}
        <p class="card-text" align="left"><strong>Hostnames :</strong></p>
        {% for host in ip.portscan.hostnames %}
            <p class="card-text" align="left" style = "margin-left: 25px;"> {{host.name}}</p>
        {% endfor %}
      {% elif key == "Ports" and value != None %}
        {% for key1,value1 in value.items %}
            <p class="card-text" align="left"><strong>Port : {{key1}}</strong></p>
              {% for key2,value2 in value1.items %}
                <p class="card-text" align="left" style = "margin-left: 25px;"><strong>{{key2}} : </strong>{{value2}}</p>
              {% endfor %}
              <br>
        {% endfor %}
      {% else %}
        <p class="card-text" align="left" style = "margin-left: 25px;" ><strong>{{key}} : </strong>{{value.ipv4}}</p>
      {% endif %}  
    {% endfor %}
  </div>
</div><br>
{% endif %}


{% if ip.censys %}
<div class="card text-center">
    <div class="card-header">
      Censys
    </div>
  <div class="card-body" align="left" style = "margin-left: 25px;">
    {% if ip.censys.Error %}
      <p class="card-text"><strong>Error : </strong> {{ip.censys.Error}}</p>
    {% else %}
      {% for key,value in ip.censys.items %}
        {% if key == "autonomous_system" %}
          {% for key1,value1 in ip.censys.autonomous_system.items %}
            <pre><strong>{{key1| pretty_json}} </strong> {{value1 | pretty_json}} </pre>
          {% endfor %}
        {% elif key == "location" %}
          {% for key1,value1 in ip.censys.location.items %}
            <pre><strong>{{key1 | pretty_json}} </strong> {{value1 | pretty_json}}</pre>
          {% endfor %}
        {% else %}
        <pre><strong>{{key | pretty_json}} </strong> {{value | pretty_json}} </pre>
        {% endif %}
      {% endfor %}
    {% endif %}
  </div>
</div><br>
{% endif %}


{% if ip.shodan %}
<div class="card text-center">
    <div class="card-header">
      Shodan
    </div>
  <div class="card-body" align="left" style = "margin-left: 25px;">
    {% if ip.shodan.Error %}
      <p class="card-text"><strong>Error : </strong> {{ip.shodan.Error}}</p>
    {% else %}
            <pre> {{ip.shodan | pretty_json}} </pre>   
    {% endif %}
  </div>
</div><br>
{% endif %}

{% if btc %}
<div class="card text-left">
    <div class="card-header" align="center">
      BitCoin Info
    </div>
  <div class="card-body">
	{% if btc.error %}
		<p class="card-text"><strong>Error : </strong> {{btc.error}}</p>
	{% else %}
		{% for keys,values in btc.items %}
			{% if keys == "transactions" %}
				<p class="card-text"><strong>{{keys}} : </strong> 
				{% for value in values %}
					<p class="card-text" align="left" style = "margin-left: 25px;">{{ forloop.counter }} : {{value}}</p>
				{% endfor %}
			{% else %}
			<p class="card-text"><strong>{{keys}} : </strong> {{values}}</p>
			{% endif %}
		{% endfor %}
	{% endif %}
	</div>
</div><br>
{% endif %}

{% if macdata %}
<div class="card text-center">
    <div class="card-header">
      Mac Address Details
    </div>
    <div class="card-body">

    {% if Error %}
      <p class="card-text"><strong>Error : </strong> {{Error}}</p>

    {% else %}
      <p class="card-text"><strong>City : </strong> {{macdata.Manufacturer}}</p>
      <p class="card-text"><strong>Region : </strong> {{macdata.Manufacturer_Address}}</p>

    {% endif %}
    </div>
  </div><br>
{% endif %}

{% if metadata %}
<div class="card text-center">
    <div class="card-header"><strong>
      Metadata Extraction Results</strong>
    </div>
    <div class="card-body">
  
    {% if metadata.Error %}
      <p class="card-text"><strong>Error : </strong> {{metadata.Error}}</p>

    {% else %}

    {% for key,value in metadata.items %}
      
      {% if value.items and key != "references_dict" %}
        {% for key1,value1 in value.items %}
			{% if value1.items %}
				{% for key2,value2 in value1.items %}
					<p class="card-text" align="left" style = "margin-left: 25px;"><strong>{{key2}} : </strong> {{value2}}</p>
				{% endfor %}
			{% else %}
				<p class="card-text" align="left" style = "margin-left: 25px;"><strong>{{key1}} : </strong> {{value1}}</p>
			{% endif %}
		{% endfor %}
	  {% elif key == "references_dict" %}
		<p class="card-text" align="left"><strong>{{key}} : </strong></p>
		{% for key1,value1 in value.items %}
				<p class="card-text" align="left" style = "margin-left: 25px;"><strong>{{key1}}</strong></p>
			{% for value2 in value1 %}
				<p class="card-text" align="left" style = "margin-left: 50px;">{{value2}}</p>
			{% endfor %}
		<br>
		{% endfor %}
		
	  {% else %}
      <p class="card-text" align="left" style = "margin-left: 25px;"><strong>{{key}} : </strong> {{value}}</p>
	{% endif %}
    {% endfor %}

    {% endif %}
    </div>
  </div><br>
{% endif %}

{% if hibp %}
<div class="card text-center">
    <div class="card-header">
      Have I Been Pwned Scan Results
    </div>
    <div class="card-body">
      {% if hibp.Error %}
        <p class="card-text">{{hibp.Error}}</p>
      {% else %}

      <h5 class="card-title">Breached Sites</h5>

        {% for i in hibp%}
          <p class="card-text"> {{i.Name}} </p>
        {% endfor %}
      {% endif %}
    </div>
</div><br>
{% endif %}

{% if emailrep %}
<div class="card text-center">
    <div class="card-header">
      Email Rep Results
    </div>
    <div class="card-body">
    {% if status not in emailrep.keys %}
      {% for keys,values in emailrep.items %}
          {% if values.items %}
            {% for key1,value1 in values.items %}
              {% if key1 == "profiles"%}
                <p class="card-text" align="left"><strong>{{key1}} : </strong><p>
                {% for profile in value1 %}
                  <p class="card-text" align="left" style = "margin-left: 25px;"><strong>{{forloop.counter}} : </strong> {{profile}}</p>
                {% endfor %}
              {% else %}
                <p class="card-text" align="left"><strong>{{key1}} : </strong> {{value1}}</p>
              {% endif %}
            {% endfor %}
          {% else %}
            <p class="card-text" align="left"><strong>{{keys}} : </strong> {{values}}</p>
          {% endif %}
      {% endfor %}
    {% endif %}
    </div>
</div><br>
{% endif %}

{% if hunterio %}
<div class="card text-center">
    <div class="card-header">
      Hunter.io Scan Results
    </div>
    <div class="card-body">
    {% if hunterio.Error %}
      <p class="card-text">{{hunterio.Error}}</p>
    {% else %}
  
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Result : </strong> {{hunterio.data.result}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Score : </strong> {{hunterio.data.score}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Email : </strong> {{hunterio.data.email}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Disposable : </strong> {{hunterio.data.disposable}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Webmail : </strong> {{hunterio.data.webmail}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>MX Records : </strong> {{hunterio.data.mx_records}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>SMTP Server : </strong> {{hunterio.data.smtp_server}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>SMTP Check : </strong> {{hunterio.data.smtp_check}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Accept All : </strong> {{hunterio.data.accept_all}}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Block : </strong> {{hunterio.data.block}}</p>

    <p class="card-text" align="left"><strong>Sources : </strong></p>

    {% for i in hunterio.data.sources %}

    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Domain : </strong> {{ i.domain }}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>URL : </strong> {{ i.uri }}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Extracted On : </strong> {{ i.extracted_on }}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Last Seen On : </strong> {{ i.last_seen_on }}</p>
    <p class="card-text" align="left" style = "margin-left: 25px;"><strong>Still on Page : </strong> {{ i.still_on_page }}</p>
    <br>

    {% endfor %}

        <br>
    {% endif %}
   </div>
</div><br>
{% endif %}

{% if gmap3 or ip.gmap3 %}
  <div class="card text-center">
    <div class="card-header">
        Google Map Location
    </div>
    <div class="card-body">
      <div id='map' width="80%" style='height:400px'>
        {% include "heatmap.html" %}
      </div>
    </div>
  </div><br>
{% endif %}

<div class="card text-center">
  <div class="card-footer text-muted">
    <strong>OSINTsploit</strong>
  </div>
</div>

</center>

{% endblock %}
